const inviteButtonText="Record and highlight with tl;dv",tldvButtonId="tldv-invite-button",tldvBotEmailAddress="invite-me@tldv.io",calendarModalEventTabName="#tabEvent > div",calendarFullScreenEventTabName="tabEventDetails",calendarModalInputElementPath="input.whsOnd.zHQkBf[aria-label='Guests']",calendarModalAddGuestSpanLabel="#tabEvent > div > div.kxh2c.AHjck.dBA1M.sUvU0d > div.Lvl1Vd > div > div.tsUyod > div > div > span > span",calendarFullScreenInputElementPath="#tabGuests > div.YxiWic.mCosT > div > span > div > div.d1dlne.WvJxMd > div.rFrNMe.Ax4B8.ULpymb.zKHdkd.Tyc9J > div.aCsJod.oJeWuf > div > div.Xb9hP > input",calendarFullScreenAddGuestLabelPath="#tabGuests > div.YxiWic.mCosT > div > span > div > div.d1dlne.WvJxMd > div.rFrNMe.Ax4B8.ULpymb.zKHdkd.Tyc9J > div.aCsJod.oJeWuf > div > div.Xb9hP > div",doNotSendInvitationEmailModalButtonPath="#yDmH0d > div.NBxL9e.iWO5td > div > div.I7OXgf.dT3uCc.gF3fI.fNxzgd.Inn9w.iWO5td > div.OE6hId.J9fJmf > div > div:nth-child(3)",sendInvitationEmailModalButtonPath="#yDmH0d > div.NBxL9e.iWO5td > div > div.I7OXgf.dT3uCc.gF3fI.fNxzgd.Inn9w.iWO5td > div.OE6hId.J9fJmf > div > div.uArJ5e.UQuaGc.kCyAyd.l3F1ye.ARrCac.HvOprf.fY7wqd.M9Bg4d",TIMEOUT=100,EVENT="event",CALENDAR_MODAL_ORGANIZER_EVENT_BUTTON_CLICK="i_will_tldv_it_calendar_modal_button_click",CALENDAR_MODAL_ORGANIZER_EVENT_LOCATION="organizer_calendar_modal",CALENDAR_FULLSCREEN_ORGANIZER_EVENT_BUTTON_CLICK="i_will_tldv_it_calendar_fullscreen_button_click",CALENDAR_FULLSCREEN_ORGANIZER_EVENT_LOCATION="organizer_calendar_fullscreen",nonAsciiCharacters=/[^\x00-\x7F]/gi,regexToRemoveOrganizerText=/Organiser/gi;function sendAnalyticsMsgToBackgroundPage({type:e=EVENT,event:t,location:n,...d}){sendMessage({type:e,event:t,location:n,...d})}function getInviteElement(){const e=chrome.runtime.getURL("img/tldv.svg"),t=document.createElement("div");return t.id="tldv-calendar-modal-container",t.innerHTML=`\n     <div class="tldv-container">\n      <div class="tldv-icon">\n        <img src=${e} alt="tldv icon">\n      </div>\n      <div class="tldv-button-container">\n        <div class="tldv-button-main">\n            <button id=${tldvButtonId} class="tldv-button">${inviteButtonText}</button>\n        </div>\n      </div>\n     </div>\n`,t}function getKeyboardEnterEvent(){return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:13})}function getInputEvent(){return new Event("input",{bubbles:!0})}function addBotEmailToCalendarGuestList(e,t){document.querySelector(e)&&document.querySelector(e).click(),document.querySelector(t).focus(),setTimeout((()=>{const e=document.querySelector(t);e.value="invite-me@tldv.io",e.dispatchEvent(getInputEvent()),e.dispatchEvent(getKeyboardEnterEvent())}),100)}function getOrganizerEmailAddress(){let e="";const t=document.querySelector("#c85 > div > div.tsUyod > div.malYxf.DtKXze > div");if(t){const n=t.childNodes;e=Array.from(n).map((e=>e.textContent.replace(regexToRemoveOrganizerText,"").replace(nonAsciiCharacters,"").trim()))[0]||""}return e}function onCalendarOrganizerModalBotButtonClick(){addBotEmailToCalendarGuestList(calendarModalAddGuestSpanLabel,calendarModalInputElementPath),setTimeout((()=>{sendAnalyticsMsgToBackgroundPage({organizerEmail:getOrganizerEmailAddress(),location:"organizer_calendar_modal",event:CALENDAR_MODAL_ORGANIZER_EVENT_BUTTON_CLICK})}),100)}function onCalendarFullScreenBotButtonClick(){addBotEmailToCalendarGuestList(calendarFullScreenAddGuestLabelPath,calendarFullScreenInputElementPath),setTimeout((()=>{sendAnalyticsMsgToBackgroundPage({organizerEmail:getOrganizerEmailAddress(),location:"organizer_calendar_fullscreen",event:CALENDAR_FULLSCREEN_ORGANIZER_EVENT_BUTTON_CLICK})}),100)}function addTldvJoinButtonToCalendarModal(){const e=getInviteElement(),t=document.querySelector("#tabEvent > div");if(null===document.getElementById(tldvButtonId)&&t){t.insertBefore(e,t.childNodes[2]);const n=document.getElementById(tldvButtonId);null!==n&&n.addEventListener("click",onCalendarOrganizerModalBotButtonClick)}}function addTldvJoinButtonToCalendarEventFullPage(){const e=getInviteElement(),t=document.getElementById("tabEventDetails");if(null===document.getElementById(tldvButtonId)&&t){t.insertBefore(e,t.childNodes[1]);const n=document.getElementById(tldvButtonId);null!==n&&n.addEventListener("click",onCalendarFullScreenBotButtonClick)}}function callInviteTriggerEndpoint(){sendMessage({type:"trigger"})}function onClickCalendarSendOrDoNotSendInvitationEmailButton(){callInviteTriggerEndpoint()}function calendarSendOrDoNotSendInvitationEmailModalTrigger(){const e=document.querySelector(doNotSendInvitationEmailModalButtonPath),t=document.querySelector(sendInvitationEmailModalButtonPath);e&&e.addEventListener("click",onClickCalendarSendOrDoNotSendInvitationEmailButton),t&&t.addEventListener("click",onClickCalendarSendOrDoNotSendInvitationEmailButton)}function addInviteButtonElementToCalendar(){addTldvJoinButtonToCalendarModal(),addTldvJoinButtonToCalendarEventFullPage(),calendarSendOrDoNotSendInvitationEmailModalTrigger()}setInterval((()=>{addInviteButtonElementToCalendar()}),100);